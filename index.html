<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>闽浙沿海自驾观察图 - Tenten 版</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        // 模拟 Lucide 图标（CDN 模式下直接写 SVG 最稳）
        const CarIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"/><circle cx="7" cy="17" r="2"/><path d="M9 17h6"/><circle cx="17" cy="17" r="2"/></svg>
        );

        const App = () => {
            const [activeDay, setActiveDay] = useState(1);

            const itinerary = [
                { day: 1, name: "霞浦", route: "温州 → 霞浦", dist: "140km / 2.5h", color: "bg-blue-500", strokeColor: "#3b82f6", coords: { x: 70, y: 28 }, from: { x: 88, y: 10 }, nodes: ["12:30 温州出发", "下午 东壁村摄影", "入住：霞浦市区"] },
                { day: 2, name: "泉州", route: "霞浦 → 泉州", dist: "240km / 3.5h", color: "bg-red-500", strokeColor: "#ef4444", coords: { x: 20, y: 72 }, from: { x: 70, y: 28 }, nodes: ["中午抵泉，入住西街", "下午：开元寺红砖", "夜游：西街古城"] },
                { day: 3, name: "莆田", route: "泉州 ➔ 莆田", dist: "80km / 1.5h", color: "bg-orange-500", strokeColor: "#f97316", coords: { x: 40, y: 55 }, from: { x: 20, y: 72 }, nodes: ["上午：关岳庙深度游", "15:00 离泉抵莆", "晚饭：莆田焖面"] },
                { day: 4, name: "宁德", route: "莆田 ➔ 宁德", dist: "200km / 3h", color: "bg-teal-500", strokeColor: "#14b8a6", coords: { x: 75, y: 38 }, from: { x: 40, y: 55 }, nodes: ["白天：湄洲岛朝圣", "17:00 抵宁德", "晚上：当地特色夜宵"] },
                { day: 5, name: "温州", route: "宁德 → 温州", dist: "160km / 2.5h", color: "bg-indigo-500", strokeColor: "#6366f1", coords: { x: 88, y: 10 }, from: { x: 75, y: 38 }, nodes: ["上午：三都澳浮城", "下午：锂电小镇漫步", "22:30 安全到家"] }
            ];

            const getCurvePath = (start, end, offsetBase = 12) => {
                const midX = (start.x + end.x) / 2;
                const midY = (start.y + end.y) / 2;
                const dx = end.x - start.x;
                const dy = end.y - start.y;
                const len = Math.sqrt(dx * dx + dy * dy); // 距离公式：$len = \sqrt{dx^2 + dy^2}$
                const dynamicOffset = offsetBase * (len / 30);
                const nx = -dy / len;
                const ny = dx / len;
                const controlX = midX + nx * dynamicOffset;
                const controlY = midY + ny * dynamicOffset;
                return `M ${start.x},${start.y} Q ${controlX},${controlY} ${end.x},${end.y}`;
            };

            const current = itinerary[activeDay - 1];

            return (
                <div className="flex flex-col md:flex-row h-screen bg-slate-50 overflow-hidden">
                    {/* 左侧：地图区域 */}
                    <div className="flex-1 relative bg-white border-r flex items-center justify-center p-4">
                        <div className="absolute top-8 left-8">
                            <h1 className="text-2xl font-bold text-slate-900">闽浙沿海自驾观察图</h1>
                            <p className="text-xs text-slate-400 font-mono italic">Long-termism Planning by Tenten</p>
                        </div>

                        <svg viewBox="0 0 100 85" className="w-full h-auto max-w-2xl">
                            <defs>
                                <marker id="arrowhead" markerWidth="3" markerHeight="3" refX="2.5" refY="1.5" orient="auto">
                                    <polygon points="0 0, 3 1.5, 0 3" fill={current.strokeColor} />
                                </marker>
                            </defs>
                            
                            {/* 绘制背景路网 */}
                            {itinerary.map((item, idx) => (
                                <path key={idx} d={getCurvePath(item.from, item.coords, 6)} fill="none" stroke="#f1f5f9" strokeWidth="0.5" strokeDasharray="1,1" />
                            ))}

                            {/* 活动路段 */}
                            <path d={getCurvePath(current.from, current.coords, 10)} fill="none" stroke={current.strokeColor} strokeWidth="1.5" markerEnd="url(#arrowhead)" className="transition-all duration-1000" />

                            {/* 城市点 */}
                            <circle cx="88" cy="10" r="2.5" fill="#1e293b" /> {/* 温州 */}
                            {itinerary.slice(0, 4).map((item) => (
                                <g key={item.day} onClick={() => setActiveDay(item.day)} className="cursor-pointer">
                                    <circle cx={item.coords.x} cy={item.coords.y} r={activeDay === item.day ? 2.5 : 1.5} fill={activeDay === item.day ? item.strokeColor : "#cbd5e1"} />
                                    <text x={item.coords.x + 3} y={item.coords.y + 1} className="text-[3px] font-bold fill-slate-600">{item.name}</text>
                                </g>
                            ))}
                        </svg>

                        {/* 悬浮信息条 */}
                        <div className="absolute bottom-8 left-8 right-8 bg-slate-900/95 backdrop-blur-md text-white p-6 rounded-2xl shadow-2xl flex justify-between items-center border border-white/10">
                            <div className="flex items-center gap-4">
                                <div className={`p-3 rounded-xl ${current.color}`}>
                                    <CarIcon />
                                </div>
                                <div>
                                    <div className="text-[10px] text-slate-500 font-mono tracking-widest uppercase">Current Route</div>
                                    <div className="text-xl font-bold">{current.route}</div>
                                </div>
                            </div>
                            <div className="text-right">
                                <div className="text-[10px] text-slate-500 font-mono">Distance</div>
                                <div className="text-xl font-bold text-blue-400">{current.dist}</div>
                            </div>
                        </div>
                    </div>

                    {/* 右侧：列表区域 */}
                    <div className="w-full md:w-[400px] bg-white p-8 overflow-y-auto">
                        <h2 className="text-xl font-bold mb-8 text-slate-900 border-b pb-4">行程执行清单</h2>
                        <div className="space-y-4">
                            {itinerary.map((item) => (
                                <div 
                                    key={item.day} 
                                    onClick={() => setActiveDay(item.day)}
                                    className={`p-6 rounded-2xl border transition-all cursor-pointer ${activeDay === item.day ? 'border-blue-500 bg-blue-50/30' : 'border-slate-100 opacity-60'}`}
                                >
                                    <div className="flex justify-between mb-2">
                                        <span className={`px-2 py-0.5 rounded text-[10px] text-white font-bold ${item.color}`}>DAY 0{item.day}</span>
                                        <span className="text-xs text-slate-400">{item.dist}</span>
                                    </div>
                                    <h3 className="font-bold text-slate-800 mb-4">{item.route}</h3>
                                    <ul className="space-y-2">
                                        {item.nodes.map((node, i) => (
                                            <li key={i} className="flex gap-2 items-start text-sm text-slate-600">
                                                <div className={`w-1 h-1 rounded-full mt-2 ${activeDay === item.day ? item.color : 'bg-slate-300'}`} />
                                                {node}
                                            </li>
                                        ))}
                                    </ul>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
